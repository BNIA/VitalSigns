---

title: Creating BNIA Indictors


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/04_Create_Acs_Indicators.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/04_Create_Acs_Indicators.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install VitalSigns dataplay geopandas
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">inst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ACS_Processing.csv&#39;</span><span class="p">)</span>
<span class="n">inst</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Shortname</th>
      <th>tables</th>
      <th>Numerator</th>
      <th>Denominators</th>
      <th>Special Table</th>
      <th>Operation</th>
      <th>Percent</th>
      <th>Come Back To</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>racdiv</td>
      <td>B02001</td>
      <td>002E|003E|04E|005E|006E|012E|001E</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>Complex</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getColName" class="doc_header"><code>getColName</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getColName</code>(<strong><code>df</code></strong>, <strong><code>col</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getColByName" class="doc_header"><code>getColByName</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getColByName</code>(<strong><code>df</code></strong>, <strong><code>col</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="addKey" class="doc_header"><code>addKey</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>addKey</code>(<strong><code>df</code></strong>, <strong><code>fi</code></strong>, <strong><code>col</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nullIfEqual" class="doc_header"><code>nullIfEqual</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nullIfEqual</code>(<strong><code>df</code></strong>, <strong><code>c1</code></strong>, <strong><code>c2</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sumInts" class="doc_header"><code>sumInts</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sumInts</code>(<strong><code>df</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">VitalSigns.acsDownload</span> <span class="kn">import</span> <span class="n">retrieve_acs_data</span>
<span class="kn">from</span> <span class="nn">dataplay.merge</span> <span class="kn">import</span> <span class="n">mergeDatasets</span>
<span class="kn">from</span> <span class="nn">dataplay.intaker</span> <span class="kn">import</span> <span class="n">Intake</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="k">def</span> <span class="nf">calculateSimpleIndicator</span><span class="p">(</span> <span class="n">shortname</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">numerators</span><span class="p">,</span> <span class="n">denominators</span><span class="p">,</span> <span class="n">aggregateTableId</span><span class="p">,</span> <span class="n">operations</span><span class="p">,</span> <span class="n">percent</span><span class="p">,</span> <span class="n">specialNote</span><span class="p">,</span> 
                             <span class="n">state</span><span class="o">=</span><span class="s1">&#39;24&#39;</span><span class="p">,</span> <span class="n">county</span><span class="o">=</span><span class="s1">&#39;510&#39;</span><span class="p">,</span> <span class="n">tract</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="s1">&#39;19&#39;</span><span class="p">,</span> <span class="n">saveAcs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columnsToInclude</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                             <span class="n">mergeUrl</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv&#39;</span><span class="p">,</span>
                             <span class="n">merge_left_col</span> <span class="o">=</span> <span class="s1">&#39;tract&#39;</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="o">=</span> <span class="s1">&#39;TRACTCE10&#39;</span><span class="p">,</span> <span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">groupBy</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span><span class="p">):</span>
  <span class="c1"># clear_output(wait=True)</span>
  <span class="k">if</span> <span class="n">shortname</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;tra&#39;</span><span class="p">,</span> <span class="s1">&#39;biz&#39;</span><span class="p">,</span> <span class="s1">&#39;mor&#39;</span><span class="p">]:</span> <span class="n">shortname</span> <span class="o">=</span> <span class="n">shortname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span>
  <span class="n">lbl</span> <span class="o">=</span> <span class="n">shortname</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">year</span>
  <span class="c1"># print(&#39;\n ~~~~~~~~~~~~~~~~~~~~ Creating:&#39;, lbl, &#39;~~~~~~~~~~~~~~~~~~~~&#39;);</span>

  <span class="c1"># Pull the data</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>

  <span class="c1"># Get the crosswalk</span>
  <span class="k">if</span> <span class="n">mergeUrl</span><span class="p">:</span>
    <span class="n">right_ds</span> <span class="o">=</span> <span class="n">Intake</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span> <span class="n">mergeUrl</span> <span class="p">)</span> 
    <span class="n">df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span> <span class="n">left_ds</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">left_col</span><span class="o">=</span><span class="n">merge_left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>

  <span class="c1"># Group and Aggregate</span>
  <span class="k">if</span> <span class="n">groupBy</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groupBy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">operations</span> <span class="o">==</span> <span class="s1">&#39;sum&#39;</span><span class="p">:</span>
      <span class="n">df</span> <span class="o">=</span> <span class="n">sumInts</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">df</span> <span class="o">=</span> <span class="n">sumInts</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> 
    <span class="c1"># print(&#39;Aggregated ACS on Crosswalk.&#39;)</span>

  <span class="c1"># Create the indicator</span>
  <span class="n">columns</span> <span class="o">=</span> <span class="n">numerators</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">denominators</span><span class="p">;</span> 
  <span class="k">if</span> <span class="p">(</span><span class="n">columnsToInclude</span><span class="p">):</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span><span class="o">+</span> <span class="n">columnsToInclude</span>
  <span class="n">fi</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span> <span class="n">regex</span> <span class="o">=</span> <span class="n">columns</span> <span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">fi</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">numerators</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">denominators</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

  <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/&quot;</span><span class="o">+</span><span class="n">shortname</span><span class="o">+</span><span class="s2">&quot;/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
  <span class="n">compareYears</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">);</span>
  <span class="n">goback</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">prevYear</span> <span class="o">=</span> <span class="n">shortname</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">-</span> <span class="n">goback</span> <span class="p">)</span>
  <span class="k">if</span> <span class="n">prevYear</span> <span class="ow">in</span> <span class="n">compareYears</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">compareYears</span><span class="p">[[</span><span class="s1">&#39;CSA2010&#39;</span><span class="p">,</span> <span class="n">prevYear</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;CSA2010&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;CSA2010&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fi</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="o">-</span> <span class="n">fi</span><span class="p">[</span> <span class="n">prevYear</span> <span class="p">]</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;percentChange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;change&#39;</span> <span class="p">]</span> <span class="o">/</span> <span class="n">fi</span><span class="p">[</span> <span class="n">prevYear</span> <span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span>

  <span class="k">if</span> <span class="n">shortname</span><span class="p">:</span>
    <span class="n">fi</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">lbl</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">)</span>
    <span class="c1"># print(&#39;Indicator Saved&#39;)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">inst</span><span class="p">[:]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Come Back To&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span> <span class="n">calculateSimpleIndicator</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Shortname&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tables&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Numerator&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Denominators&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Special Table&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Operation&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Percent&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Come Back To&#39;</span><span class="p">])</span>
  <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1"> --&gt; &#39;</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Shortname&#39;</span><span class="p">],</span> <span class="s1">&#39;--&gt;&#39;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Come Back To&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
 --&gt;  racdiv --&gt; Complex

 --&gt;  othrcom --&gt; 100 - ( walked + drvalone + carpool + pubtran + workfromhome )

 --&gt;  hhpov --&gt; Null if Equal
Number of Columns 21
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/pasi/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B03002_001E_Total:&#39;,
       &#39;B03002_006E_Total:_Not_Hispanic_or_Latino:_Asian_alone&#39;, &#39;pasi_19&#39;,
       &#39;pasi19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  elheat --&gt; nullif

 --&gt;  empl --&gt; nullif

 --&gt;  fam --&gt; df[df.index != &#39;Unassigned--Jail&#39;]
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/female/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Number of Columns 19
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/femhhs/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;,
       &#39;B11005_002E_Total:_Households_with_one_or_more_people_under_18_years:&#39;,
       &#39;B11005_007E_Total:_Households_with_one_or_more_people_under_18_years:_Family_households:_Other_family:_Female_householder,_no_spouse_present&#39;,
       &#39;femhhs_19&#39;, &#39;femhhs19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  heatgas --&gt; nullif

 --&gt;  hh40inc --&gt; nullif

 --&gt;  hh60inc --&gt; nullif

 --&gt;  hh75inc --&gt; nullif
Number of Columns 59
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;,
       &#39;B17001_004E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_Under_5_years&#39;,
       &#39;B17001_005E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_5_years&#39;,
       &#39;B17001_006E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_6_to_11_years&#39;,
       &#39;B17001_007E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_12_to_14_years&#39;,
       &#39;B17001_008E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_15_years&#39;,
       &#39;B17001_009E_Total:_Income_in_the_past_12_months_below_poverty_level:_Male:_16_and_17_years&#39;,
       &#39;B17001_018E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_Under_5_years&#39;,
       &#39;B17001_019E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_5_years&#39;,
       &#39;B17001_020E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_6_to_11_years&#39;,
       &#39;B17001_021E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_12_to_14_years&#39;,
       &#39;B17001_022E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_15_years&#39;,
       &#39;B17001_023E_Total:_Income_in_the_past_12_months_below_poverty_level:_Female:_16_and_17_years&#39;,
       &#39;B17001_033E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_Under_5_years&#39;,
       &#39;B17001_034E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_5_years&#39;,
       &#39;B17001_035E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_6_to_11_years&#39;,
       &#39;B17001_036E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_12_to_14_years&#39;,
       &#39;B17001_037E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_15_years&#39;,
       &#39;B17001_038E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Male:_16_and_17_years&#39;,
       &#39;B17001_047E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_Under_5_years&#39;,
       &#39;B17001_048E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_5_years&#39;,
       &#39;B17001_049E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_6_to_11_years&#39;,
       &#39;B17001_050E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_12_to_14_years&#39;,
       &#39;B17001_051E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_15_years&#39;,
       &#39;B17001_052E_Total:_Income_in_the_past_12_months_at_or_above_poverty_level:_Female:_16_and_17_years&#39;,
       &#39;hhchpov_19&#39;, &#39;hhchpov19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 17
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/hhm75/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B19001_001E_Total:&#39;, &#39;B19001_002E_Total:_Less_than_$10,000&#39;,
       &#39;B19001_003E_Total:_$10,000_to_$14,999&#39;,
       &#39;B19001_004E_Total:_$15,000_to_$19,999&#39;,
       &#39;B19001_005E_Total:_$20,000_to_$24,999&#39;,
       &#39;B19001_006E_Total:_$25,000_to_$29,999&#39;,
       &#39;B19001_007E_Total:_$30,000_to_$34,999&#39;,
       &#39;B19001_008E_Total:_$35,000_to_$39,999&#39;,
       &#39;B19001_009E_Total:_$40,000_to_$44,999&#39;,
       &#39;B19001_010E_Total:_$45,000_to_$49,999&#39;,
       &#39;B19001_011E_Total:_$50,000_to_$59,999&#39;,
       &#39;B19001_012E_Total:_$60,000_to_$74,999&#39;, &#39;hhm75_19&#39;, &#39;hhm7519&#39;],
      dtype=&#39;object&#39;)
Number of Columns 19
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/hhs/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B11005_001E_Total:&#39;,
       &#39;B11005_004E_Total:_Households_with_one_or_more_people_under_18_years:_Family_households:_Married-couple_family&#39;,
       &#39;B11005_013E_Total:_Households_with_no_people_under_18_years:_Family_households:_Married-couple_family&#39;,
       &#39;hhs_19&#39;, &#39;hhs19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  hsdipl --&gt; nullif

 --&gt;  lesshs --&gt; nullif

 --&gt;  male --&gt; nan

 --&gt;  nilf --&gt; nullif

 --&gt;  p2more --&gt; nan

 --&gt;  pubtran --&gt; ( value[3] / nullif((value[1]-value[2]),0) )*100
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/age5_/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B01001_001E_Total:&#39;, &#39;age5__19&#39;, &#39;age5_19&#39;], dtype=&#39;object&#39;)
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/age18_/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B01001_001E_Total:&#39;,
       &#39;B01001_004E_Total:_Male:_5_to_9_years&#39;,
       &#39;B01001_005E_Total:_Male:_10_to_14_years&#39;,
       &#39;B01001_006E_Total:_Male:_15_to_17_years&#39;,
       &#39;B01001_028E_Total:_Female:_5_to_9_years&#39;,
       &#39;B01001_029E_Total:_Female:_10_to_14_years&#39;,
       &#39;B01001_030E_Total:_Female:_15_to_17_years&#39;, &#39;age18__19&#39;, &#39;age18_19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/age24_/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B01001_001E_Total:&#39;, &#39;age24__19&#39;, &#39;age24_19&#39;], dtype=&#39;object&#39;)
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/age64_/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B01001_001E_Total:&#39;,
       &#39;B01001_011E_Total:_Male:_25_to_29_years&#39;,
       &#39;B01001_012E_Total:_Male:_30_to_34_years&#39;,
       &#39;B01001_013E_Total:_Male:_35_to_39_years&#39;,
       &#39;B01001_014E_Total:_Male:_40_to_44_years&#39;,
       &#39;B01001_015E_Total:_Male:_45_to_49_years&#39;,
       &#39;B01001_016E_Total:_Male:_50_to_54_years&#39;,
       &#39;B01001_017E_Total:_Male:_55_to_59_years&#39;,
       &#39;B01001_018E_Total:_Male:_60_and_61_years&#39;,
       &#39;B01001_019E_Total:_Male:_62_to_64_years&#39;,
       &#39;B01001_035E_Total:_Female:_25_to_29_years&#39;,
       &#39;B01001_036E_Total:_Female:_30_to_34_years&#39;,
       &#39;B01001_037E_Total:_Female:_35_to_39_years&#39;,
       &#39;B01001_038E_Total:_Female:_40_to_44_years&#39;,
       &#39;B01001_039E_Total:_Female:_45_to_49_years&#39;,
       &#39;B01001_040E_Total:_Female:_50_to_54_years&#39;,
       &#39;B01001_041E_Total:_Female:_55_to_59_years&#39;,
       &#39;B01001_042E_Total:_Female:_60_and_61_years&#39;,
       &#39;B01001_043E_Total:_Female:_62_to_64_years&#39;, &#39;age64__19&#39;, &#39;age64_19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/age65_/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B01001_001E_Total:&#39;,
       &#39;B01001_020E_Total:_Male:_65_and_66_years&#39;,
       &#39;B01001_021E_Total:_Male:_67_to_69_years&#39;,
       &#39;B01001_022E_Total:_Male:_70_to_74_years&#39;,
       &#39;B01001_023E_Total:_Male:_75_to_79_years&#39;,
       &#39;B01001_024E_Total:_Male:_80_to_84_years&#39;,
       &#39;B01001_025E_Total:_Male:_85_years_and_over&#39;,
       &#39;B01001_044E_Total:_Female:_65_and_66_years&#39;,
       &#39;B01001_045E_Total:_Female:_67_to_69_years&#39;,
       &#39;B01001_046E_Total:_Female:_70_to_74_years&#39;,
       &#39;B01001_047E_Total:_Female:_75_to_79_years&#39;,
       &#39;B01001_048E_Total:_Female:_80_to_84_years&#39;,
       &#39;B01001_049E_Total:_Female:_85_years_and_over&#39;, &#39;age65__19&#39;,
       &#39;age65_19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  affordm --&gt; nullif

 --&gt;  affordr --&gt; nullif

 --&gt;  bahigher --&gt; nullif

 --&gt;  carpool --&gt; ( value[3] / nullif((value[1]-value[2]),0) )*100

 --&gt;  drvalone --&gt; ( value[3] / nullif((value[1]-value[2]),0) )*100

 --&gt;  hh25inc --&gt; nullif

 --&gt;  mhhi --&gt; Complex Calculation

 --&gt;  nohhint --&gt; nullif

 --&gt;  novhcl --&gt; nullif
Number of Columns 21
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/paa/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B03002_001E_Total:&#39;,
       &#39;B03002_004E_Total:_Not_Hispanic_or_Latino:_Black_or_African_American_alone&#39;,
       &#39;paa_19&#39;, &#39;paa19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 21
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/ppac/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B03002_001E_Total:&#39;, &#39;ppac_19&#39;, &#39;ppac19&#39;], dtype=&#39;object&#39;)
Number of Columns 21
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/phisp/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B03002_001E_Total:&#39;,
       &#39;B03002_012E_Total:_Hispanic_or_Latino:&#39;, &#39;phisp_19&#39;, &#39;phisp19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 21
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/pwhite/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B03002_001E_Total:&#39;,
       &#39;B03002_003E_Total:_Not_Hispanic_or_Latino:_White_alone&#39;, &#39;pwhite_19&#39;,
       &#39;pwhite19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  sclemp --&gt; nullif
Number of Columns 49
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/tpop/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson

 --&gt;  trav14 --&gt; nullif

 --&gt;  trav29 --&gt; nullif

 --&gt;  trav44 --&gt; nullif

 --&gt;  trav45 --&gt; nullif
Number of Columns 173
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/unempl/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;, &#39;B23001_003E_Total:_Male:_16_to_19_years:&#39;,
       &#39;B23001_008E_Total:_Male:_16_to_19_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_010E_Total:_Male:_20_and_21_years:&#39;,
       &#39;B23001_015E_Total:_Male:_20_and_21_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_017E_Total:_Male:_22_to_24_years:&#39;,
       &#39;B23001_022E_Total:_Male:_22_to_24_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_024E_Total:_Male:_25_to_29_years:&#39;,
       &#39;B23001_029E_Total:_Male:_25_to_29_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_031E_Total:_Male:_30_to_34_years:&#39;,
       &#39;B23001_036E_Total:_Male:_30_to_34_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_038E_Total:_Male:_35_to_44_years:&#39;,
       &#39;B23001_043E_Total:_Male:_35_to_44_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_045E_Total:_Male:_45_to_54_years:&#39;,
       &#39;B23001_050E_Total:_Male:_45_to_54_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_052E_Total:_Male:_55_to_59_years:&#39;,
       &#39;B23001_057E_Total:_Male:_55_to_59_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_059E_Total:_Male:_60_and_61_years:&#39;,
       &#39;B23001_064E_Total:_Male:_60_and_61_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_066E_Total:_Male:_62_to_64_years:&#39;,
       &#39;B23001_071E_Total:_Male:_62_to_64_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_089E_Total:_Female:_16_to_19_years:&#39;,
       &#39;B23001_094E_Total:_Female:_16_to_19_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_096E_Total:_Female:_20_and_21_years:&#39;,
       &#39;B23001_101E_Total:_Female:_20_and_21_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_103E_Total:_Female:_22_to_24_years:&#39;,
       &#39;B23001_108E_Total:_Female:_22_to_24_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_110E_Total:_Female:_25_to_29_years:&#39;,
       &#39;B23001_115E_Total:_Female:_25_to_29_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_117E_Total:_Female:_30_to_34_years:&#39;,
       &#39;B23001_122E_Total:_Female:_30_to_34_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_124E_Total:_Female:_35_to_44_years:&#39;,
       &#39;B23001_129E_Total:_Female:_35_to_44_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_131E_Total:_Female:_45_to_54_years:&#39;,
       &#39;B23001_136E_Total:_Female:_45_to_54_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_138E_Total:_Female:_55_to_59_years:&#39;,
       &#39;B23001_143E_Total:_Female:_55_to_59_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_145E_Total:_Female:_60_and_61_years:&#39;,
       &#39;B23001_150E_Total:_Female:_60_and_61_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_152E_Total:_Female:_62_to_64_years:&#39;,
       &#39;B23001_157E_Total:_Female:_62_to_64_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;unempl_19&#39;, &#39;unempl19&#39;],
      dtype=&#39;object&#39;)
Number of Columns 173
https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/unempr/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Index([&#39;CSA2010&#39;,
       &#39;B23001_006E_Total:_Male:_16_to_19_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_008E_Total:_Male:_16_to_19_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_013E_Total:_Male:_20_and_21_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_015E_Total:_Male:_20_and_21_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_020E_Total:_Male:_22_to_24_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_022E_Total:_Male:_22_to_24_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_027E_Total:_Male:_25_to_29_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_029E_Total:_Male:_25_to_29_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_034E_Total:_Male:_30_to_34_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_036E_Total:_Male:_30_to_34_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_041E_Total:_Male:_35_to_44_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_043E_Total:_Male:_35_to_44_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_048E_Total:_Male:_45_to_54_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_050E_Total:_Male:_45_to_54_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_055E_Total:_Male:_55_to_59_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_057E_Total:_Male:_55_to_59_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_062E_Total:_Male:_60_and_61_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_064E_Total:_Male:_60_and_61_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_069E_Total:_Male:_62_to_64_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_071E_Total:_Male:_62_to_64_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_092E_Total:_Female:_16_to_19_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_094E_Total:_Female:_16_to_19_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_099E_Total:_Female:_20_and_21_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_101E_Total:_Female:_20_and_21_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_106E_Total:_Female:_22_to_24_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_108E_Total:_Female:_22_to_24_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_113E_Total:_Female:_25_to_29_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_115E_Total:_Female:_25_to_29_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_120E_Total:_Female:_30_to_34_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_122E_Total:_Female:_30_to_34_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_127E_Total:_Female:_35_to_44_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_129E_Total:_Female:_35_to_44_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_134E_Total:_Female:_45_to_54_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_136E_Total:_Female:_45_to_54_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_141E_Total:_Female:_55_to_59_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_143E_Total:_Female:_55_to_59_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_148E_Total:_Female:_60_and_61_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_150E_Total:_Female:_60_and_61_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;B23001_155E_Total:_Female:_62_to_64_years:_In_labor_force:_Civilian:&#39;,
       &#39;B23001_157E_Total:_Female:_62_to_64_years:_In_labor_force:_Civilian:_Unemployed&#39;,
       &#39;unempr_19&#39;, &#39;unempr19&#39;],
      dtype=&#39;object&#39;)

 --&gt;  walked --&gt; ( value[3] / nullif((value[1]-value[2]),0) )*100

 --&gt;  nan --&gt; nan
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>IMPORT THE MODULES FROM THE OTHER LIBRARY USING PIP</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Awesome!</p>
<p>By this point you should be able to download a dataset, and crosswalk new columns onto it by matching on 'tract'</p>
<p>What we are going to do now is perform calculations using these newly created datasets.</p>
<p>Run the next few cells to create our calculatory functions</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#File: affordr.py</span>
<span class="c1">#Author: Charles Karpati</span>
<span class="c1">#Date: 1/17/19</span>
<span class="c1">#Section: Bnia</span>
<span class="c1">#Email: karpati1@umbc.edu</span>
<span class="c1">#Description: </span>
<span class="c1"># Uses ACS Table B25070 - GROSS RENT AS A PERCENTAGE OF HOUSEHOLD INCOME IN THE PAST 12 MONTHS </span>
<span class="c1"># Universe: Renter-occupied housing units</span>
<span class="c1">#purpose: Produce Housing and Community Development - Affordability Index - Rent Indicator</span>
<span class="c1">#input: </span>
<span class="c1">#output: </span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="k">def</span> <span class="nf">affordr</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">columnsToInclude</span> <span class="p">):</span>    
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 2)</span>
    <span class="c1"># Prepare the columns</span>
    <span class="c1">#~~~~~~~~~~~~~~~ </span>

    <span class="c1"># Final Dataframe  </span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25070_007E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_008E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_009E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_010E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_001E&#39;</span><span class="p">,</span> <span class="s1">&#39;tract&#39;</span><span class="p">]</span> 
    <span class="n">columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">columnsToInclude</span><span class="p">)</span> 
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

    <span class="c1"># Numerators </span>
    <span class="n">numerators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25070_007E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_008E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_009E&#39;</span><span class="p">,</span><span class="s1">&#39;B25070_010E&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">numerators</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">numerators</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    
    <span class="c1"># Denominators</span>
    <span class="n">denominators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25070_001E&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">denominators</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">denominators</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="c1"># construct the denominator, returns 0 iff the other two rows are equal.</span>

    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 3)</span>
    <span class="c1"># Run the Calculation </span>
    <span class="c1"># ( (value[1]+value[2]+value[3]+value[4]) / nullif(value[5],0) )*100</span>
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;numerator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerators</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">denominators</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># Delete Rows where the &#39;denominator&#39; column is 0</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="s1">&#39;numerator&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="k">return</span> <span class="n">fi</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#File: affordm.py</span>
<span class="c1">#Author: Charles Karpati</span>
<span class="c1">#Date: 1/25/19</span>
<span class="c1">#Section: Bnia</span>
<span class="c1">#Email: karpati1@umbc.edu</span>
<span class="c1">#Description: </span>
<span class="c1"># Uses ACS Table B25091 - MORTGAGE STATUS BY SELECTED MONTHLY OWNER COSTS AS A PERCENTAGE OF HOUSEHOLD INCOME IN THE PAST 12 MONTHS</span>
<span class="c1"># Universe: Owner-occupied housing units</span>
<span class="c1"># Table Creates: </span>
<span class="c1">#purpose: Produce Housing and Community Development - Affordability Index - Mortgage Indicator</span>
<span class="c1">#input: </span>
<span class="c1">#output: </span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="k">def</span> <span class="nf">affordm</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">columnsToInclude</span> <span class="p">):</span>  
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 1)</span>
    <span class="c1"># Prepare the columns</span>
    <span class="c1">#~~~~~~~~~~~~~~~ </span>

    <span class="c1"># Final Dataframe  </span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25091_008E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_009E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_010E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_011E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_002E&#39;</span><span class="p">,</span> <span class="s1">&#39;tract&#39;</span><span class="p">]</span> 
    <span class="n">columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">columnsToInclude</span><span class="p">)</span> 
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

    <span class="c1"># Numerators </span>
    <span class="n">numerators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25091_008E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_009E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_010E&#39;</span><span class="p">,</span><span class="s1">&#39;B25091_011E&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">numerators</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">numerators</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    
    <span class="c1"># Denominators</span>
    <span class="n">denominators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B25091_002E&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">denominators</span> <span class="o">=</span> <span class="n">addKey</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">denominators</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="c1"># construct the denominator, returns 0 iff the other two rows are equal.</span>

    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="c1"># Step 3)</span>
    <span class="c1"># Run the Calculation </span>
    <span class="c1"># ( (value[1]+value[2]+value[3]+value[4]) / nullif(value[5],0) )*100</span>
    <span class="c1">#~~~~~~~~~~~~~~~</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;numerator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numerators</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">denominators</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fi</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># Delete Rows where the &#39;denominator&#39; column is 0</span>
    <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;final&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fi</span><span class="p">[</span><span class="s1">&#39;numerator&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">fi</span><span class="p">[</span><span class="s1">&#39;denominator&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="k">return</span> <span class="n">fi</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="age5" class="doc_header"><code>age5</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>age5</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="age18" class="doc_header"><code>age18</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L80" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>age18</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="age24" class="doc_header"><code>age24</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>age24</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="age64" class="doc_header"><code>age64</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L148" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>age64</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="age65" class="doc_header"><code>age65</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L167" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>age65</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bahigher" class="doc_header"><code>bahigher</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L186" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bahigher</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="carpool" class="doc_header"><code>carpool</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L205" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>carpool</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="drvalone" class="doc_header"><code>drvalone</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L706" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>drvalone</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="elheat" class="doc_header"><code>elheat</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L247" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>elheat</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="empl" class="doc_header"><code>empl</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L267" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>empl</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fam" class="doc_header"><code>fam</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L287" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fam</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="female" class="doc_header"><code>female</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L308" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>female</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="femhhs" class="doc_header"><code>femhhs</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L328" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>femhhs</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="heatgas" class="doc_header"><code>heatgas</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L348" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>heatgas</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hisp" class="doc_header"><code>hisp</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L368" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hisp</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hh25inc" class="doc_header"><code>hh25inc</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L390" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hh25inc</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hh40inc" class="doc_header"><code>hh40inc</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L414" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hh40inc</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hh60inc" class="doc_header"><code>hh60inc</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L434" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hh60inc</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hh75inc" class="doc_header"><code>hh75inc</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L454" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hh75inc</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hhchpov" class="doc_header"><code>hhchpov</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L474" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hhchpov</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hhm75" class="doc_header"><code>hhm75</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L494" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hhm75</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hhs" class="doc_header"><code>hhs</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L514" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hhs</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hsdipl" class="doc_header"><code>hsdipl</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L534" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hsdipl</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="lesshs" class="doc_header"><code>lesshs</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L554" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>lesshs</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="male" class="doc_header"><code>male</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L574" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>male</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mhhi" class="doc_header"><code>mhhi</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L607" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mhhi</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="drvalone" class="doc_header"><code>drvalone</code><a href="__main__.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>drvalone</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="novhcl" class="doc_header"><code>novhcl</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L727" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>novhcl</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nohhint" class="doc_header"><code>nohhint</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L748" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nohhint</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="othercom" class="doc_header"><code>othercom</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L777" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>othercom</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="paa" class="doc_header"><code>paa</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L797" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>paa</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="p2more" class="doc_header"><code>p2more</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L819" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>p2more</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pasi" class="doc_header"><code>pasi</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L839" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pasi</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pubtran" class="doc_header"><code>pubtran</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L860" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pubtran</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pwhite" class="doc_header"><code>pwhite</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L880" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pwhite</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sclemp" class="doc_header"><code>sclemp</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L906" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sclemp</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tpop" class="doc_header"><code>tpop</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L926" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tpop</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="trav14" class="doc_header"><code>trav14</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L965" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>trav14</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="trav14" class="doc_header"><code>trav14</code><a href="__main__.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>trav14</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="trav45" class="doc_header"><code>trav45</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L998" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>trav45</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="trav44" class="doc_header"><code>trav44</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L1050" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>trav44</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>=<em><code>[]</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unempr" class="doc_header"><code>unempr</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L1108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unempr</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unempr" class="doc_header"><code>unempr</code><a href="__main__.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unempr</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="walked" class="doc_header"><code>walked</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L1128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>walked</code>(<strong><code>df</code></strong>, <strong><code>columnsToInclude</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that our calculations have been created, lets:</p>
<ul>
<li>create a final function that will download our data, </li>
<li>optionally crosswalk and </li>
<li>optionally aggregate it, and then </li>
<li>run/return the appropriate calculation. </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">capture</span>
!pip install geopandas VitalSigns dataplay
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>1 no denom
2 no percent
3 sum = false or sum or median
4 nullif / jail
null if equal</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="createAcsIndicator" class="doc_header"><code>createAcsIndicator</code><a href="https://github.com/bnia/VitalSigns/tree/main/VitalSigns/create.py#L1152" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>createAcsIndicator</code>(<strong><code>state</code></strong>, <strong><code>county</code></strong>, <strong><code>tract</code></strong>, <strong><code>year</code></strong>, <strong><code>tableId</code></strong>, <strong><code>mergeUrl</code></strong>, <strong><code>merge_left_col</code></strong>, <strong><code>merge_right_col</code></strong>, <strong><code>merge_how</code></strong>, <strong><code>groupBy</code></strong>, <strong><code>aggMethod</code></strong>, <strong><code>method</code></strong>, <strong><code>columnsToInclude</code></strong>, <strong><code>finalFileName</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Run-Em">Run Em<a class="anchor-link" href="#Run-Em"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19001&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">mergeUrl</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv&#39;</span>
<span class="n">merge_left_col</span> <span class="o">=</span> <span class="s1">&#39;tract&#39;</span>
<span class="n">merge_right_col</span><span class="o">=</span> <span class="s1">&#39;TRACTCE10&#39;</span> 
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">groupBy</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>

<span class="n">method</span> <span class="o">=</span> <span class="n">mhhi</span>
<span class="n">aggMethod</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span>
<span class="n">columnsToInclude</span> <span class="o">=</span> <span class="p">[]</span>


<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B08303&#39;</span>
<span class="n">finalFileName</span> <span class="o">=</span> <span class="s1">&#39;./trav45_20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_tracts_26July2019.csv&#39;</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">trav45</span>
<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B08303&#39;</span>
<span class="n">finalFileName</span> <span class="o">=</span> <span class="s1">&#39;./trav44_20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_tracts_26July2019.csv&#39;</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">trav44</span>
<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B25070&#39;</span>
<span class="n">finalFileName</span> <span class="o">=</span> <span class="s1">&#39;./affordr_20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_tracts_26July2019.csv&#39;</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">affordr</span>
<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B25091&#39;</span>
<span class="n">finalFileName</span> <span class="o">=</span> <span class="s1">&#39;./affordm_20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_tracts_26July2019.csv&#39;</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">affordm</span>
<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B01001&#39;</span>
<span class="n">finalFileName</span> <span class="o">=</span> <span class="s1">&#39;./age5_20&#39;</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s1">&#39;_communities_9Sept2019.csv&#39;</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">age5</span>
<span class="n">groupBy</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>
<span class="n">columnsToInclude</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">createAcsIndicator</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">,</span>
                    <span class="n">mergeUrl</span><span class="p">,</span> <span class="n">merge_left_col</span><span class="p">,</span> <span class="n">merge_right_col</span><span class="p">,</span> <span class="n">merge_how</span><span class="p">,</span> <span class="n">groupBy</span><span class="p">,</span>
                    <span class="n">aggMethod</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">columnsToInclude</span><span class="p">,</span> <span class="n">finalFileName</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

